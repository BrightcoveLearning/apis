---
title: 'Overview: Data Collection API v2'
description: 'In this topic, you will get an overview of the Analytics Data Collection API v2, which allows you to add events to your Video Cloud Analytics data in situations where Brightcove cannot track the events directly.'
parent: Data Collection API
---

<style media="screen" type="text/css">
dt {
  border-top: 1px #ccc solid;
  padding-top: 1.5rem;
  padding-bottom: 0;
  margin-bottom: 0;
}
  </style>

<article class="bcls-article">
  <h1>{{ page.title }}</h1>
  <summary>{{ page.description }}</summary>
  <p class="player-only">This feature is for Video Cloud customers only.</p>
  <aside class="bcls-aside bcls-aside--warning language-editable"><strong>Note:</strong> You should NOT use this API to track events for the Brightcove Player, or for the Android and iOS SDK players, because that already happens automatically, and you would be adding duplicate data.</aside>
  <section class="bcls-section video-cloud-only">
  <h2 id="introduction">Introduction</h2>
  
  <p>Analytics data is sent automatically by the Brightcove Players, including those provided by the Native Player SDKs. If you are <strong>not</strong> using a Brightcove Player to deliver Video Cloud videos, you need to instrument the player you are using to send the data to the Data Collector.</p>
  
  <p>Data Collection API v2 is the current standard. The v1 version is deprecated. If you have a v1 implementation, see the <a href="#changesFromV1">Changes from v1</a> section below.</p>
  
  <p>In addition to this overview and the <a href="/data-collection/references/reference.html">API Reference</a>, also see this <a href="/data-collection/data-collection-api-sample.html">sample implementation</a>.</p>
  
  <p>The Analytics Data Collection API is the endpoint for realtime analytics events. Event data is sent to Brightcove via a series of parameters submitted via HTTP requests, such as:</p>
  
  <pre class="line-numbers" style="white-space:pre-wrap;padding-top:1em;padding-bottom:1em;">
  <code class="language-http notranslate">http://metrics.brightcove.com/v2/tracker?event=video_view&amp;amp;domain=videocloud&amp;account=123&amp;video=789
  </code>
  </pre>
  
  <p>These parameters describe a <strong>fact</strong> about the state of the system when an event occurred. The example above describes the fact that a <code>video_view</code> event occurred for video <code>789</code> for account <code>123</code> (or: a user started watching account <code>123</code>'s video <code>789</code>. See <a href="#video-cloud-events">below</a> for a description of the current analytics events tracked).</p>
  
  <h3 id="dimensions">Dimensions</h3>
  
  <p>Dimensions are qualitative facts about the state of the system when an event occurs. For example, if the request is:</p>
  
  <pre class="line-numbers" style="white-space:pre-wrap;padding-top:1em;padding-bottom:1em;">
  <code class="language-http notranslate">http://metrics.brightcove.com/tracker
  ?event=video_view&amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;domain=videocloud&amp;account=123
  &amp;video=789
  </code>
  </pre>
  
  <p>The video ID ( <code>789</code>) and account ID ( <code>123</code>), and any device and location information gleaned from the request itself are all dimensions related to the <code>video_view</code> event. The Analytics system will record that a <code>video_view</code> event occurred when this request was made, with these dimensions.</p>
  
  <h3 id="event-and-domain-parameters">Event and domain parameters</h3>
  
  <p>The <code>event</code> parameter describes which event has occurred. The <code>domain</code> parameter provides a namespace for events. The <code>event</code>, <code>domain</code>, and <code>session</code> are required parameters (the value of <code>domain</code> is always <code>videocloud</code>).</p>
  
  <h3 id="additional-parameters">Additional parameters</h3>
  
  <p class="video-cloud-only">Certain parameters must be included with events so that the Analytics system can successfully analyze them</p>
  
  <aside class="bcls-aside bcls-aside--warning">You should <strong>not</strong> send <code>player</code> (player ID) or <code>player_name</code> information for non-Brightcove players. Instead, use the <code>destination</code> parameter to track where the video was viewed.</aside>
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="responseTypes">Response types</h2>
  
  <p>The response to an analytics data collection API request includes an HTTP response code and a human-readable message.</p>
  
  <table class="bcls-table" style="background-color:#ffffff;">
    <thead class="bcls-table__head">
      <tr>
        <th>HTTP Status Code</th>
        <th>Description</th>
        <th>Example</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>200</code></td>
        <td>The request was successfully received by the collector and has been persisted.</td>
        <td>(returns a 1x1 pixel transparent GIF image)</td>
      </tr>
      <tr>
        <td><code>400</code></td>
        <td>The request sent by the client is missing a required parameter: <code>domain</code>, <code>account</code> or <code>event</code>. (This status will not be returned if domain-specific parameters are missing.)</td>
        <td><code>"Invalid 'event' parameter"</code></td>
      </tr>
      <tr>
        <td><code>50x</code></td>
        <td>This is error code indicates a problem on the server side. Your event may or may not have been successfully recorded by the analytics system.</td>
        <td><code>"Server-side failure, please retry."</code></td>
      </tr>
    </tbody>
  </table>
  </section>
  
  <section class="bcls-section">
  <h2 id="minimal">Minimal data</h2>
  
  <p>At a minimum, you should send a <code>session</code> id and <code>video_view</code> event for every video played during a session. The <code>video_view</code> should sent <em>after</em> any pre-roll ads complete.</p>
  
  <h3><code>session</code></h3>
  
  <p>This is the session identifier. The <code>session</code> is essentially one view of a page or app view that has a player in it, for as long as that lasts. The value should be constant for the duration of the session and <strong>sent for all events</strong>. It should be as close as is possible to a globally unique identifier (GUID). If there are collisions, the two sessions may be discarded as invalid if they cannot be disentangled.</p>
  
  <p>There are various schemes for creating GUIDs in JavaScript. One example is in <a href="https://github.com/dustinpoissant/GUIDJS">this GitHub repository</a>. Please be aware that third-party scripts are not supported by Brightcove.</p>
  
  <aside class="bcls-aside bcls-aside--warning">Note that the Analytics system can only return what you give it - not sending full data will result in a lack of data in Video Cloud analytics.</aside>
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="bestPractices">Best practices</h2>
  
  <p>To be sure that you are sending the correct data to the Collector, you should test your data collection script before generally deploying it. We recommend:</p>
  
  <ol>
    <li>Build the data collection script for your player.</li>
    <li>Test in a controlled environment for at least a day.</li>
    <li>Check the analytics data either through the Analytics Module or the Analytics API to ensure that what was collected matches your expectations.</li>
  </ol>
  
  <h3>Sending the request - avoiding CORS issues</h3>
  
  <aside class="bcls-aside bcls-aside--tip">
  <p>Note that the best way to "send" to the Data Collection API is by setting the request URL as the <code>src</code> value for a new image ( <code>img</code>) element and then injecting that element into the page.</p>
  
  <p>You should use the same method rather than <code>XMLHttpRequest</code> or some other in order to avoid <a href="https://general.support.brightcove.com/developer/concepts-cors.html">CORS</a> issues.</p>
  
  <p>For a sample implementation, see the <a href="/data-collection/data-collection-api-sample.html">Data Collection Sample</a>.</p>
  </aside>
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="junk-data">Junk data</h2>
  
  <p><strong>In general, data sent to the Collector will be recorded as truth by the Analytics system.</strong> If an event contains inappropriate or incorrect information, the Analytics system will interpret the data incorrectly.</p>
  
  <p>For example, if you accidentally send the timestamp as the video ID, your analytics data will be skewed in ways that affect the overall summarization.</p>
  
  <aside class="bcls-aside bcls-aside--tip">Examine the URLs you are generating carefully before you start sending data!</aside>
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="encoding">URI Encoding</h2>
  
  <p>Any strings you send to the Data Collection API that might contain spaces or special characters <strong>must be URI encoded</strong> for the request to be successful. If you are submitting the request via JavaScript, you can use the <code class="language-javascript notranslate">encodeURI()</code> method the encode the request string. For example:</p>
  
  <pre class="line-numbers">
  <code class="language-javascript notranslate">urlStr += "&amp;video=" + currentVideo.id + "&amp;video_name=" + encodeURI(currentVideo.video_name);
  </code>
  </pre>
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="video-cloud-events">Events</h2>
  
  <p>The events listed below are processed by the Analytics system.</p>

  <dl>
    <dt><code>player_load</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>A player session has been initiated by an end-user. This marks the beginning of the analytics session, and should be sent before any other events.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=player_load
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %2Furl%3Fsa%3D-t%26rct%3Dj%26q%3D%26esrc%3Ds%26source
  %253A-%252F%252Fsupport.brightcove.com%252F%26ei%3D
  OdxWZSGdJ-pL7WJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>error</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when fatal errors which disrupt the playback experience are encountered.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=error
  &amp;error_code=MEDIA_ERR_SRC_NOT_SUPPORTED
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %3Dhttp%253A-%252F%252Fsupport.brightcove.com
  %26usgWZSGdJ-pL7WJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>catalog_request</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when a request to the Video Cloud Playback API is made.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=catalog_request
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;catalog_url=https%3A%2F%2Fedge.api.brightcove.com%2Fplayback
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %3Dhttp%253A-%252F%252Fsupport.brightcove.com
  WZSGdJ-pL7WJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud&amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>catalog_response</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when a response to a prior <code>catalog_request</code> is received.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=catalog_response
  &amp;session=581136_2018-07-03T18:34:46.
  &amp;catalog_url=https%3A%2F%2Fedge.api.brightcove.com%2Fp2F23823423800
  &amp;response_time_ms=243
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  53A-%252F%252Fsupport.brightcove.com%252F%2Tzn-oCgCQ
  AFQjCNJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>play_request</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when the playback is initiated either by the user expressly clicking the play button, or automatically when the platform triggers playback in an auto-play scenario.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=play_request
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %3Dhttp%253A-%252F%252Fsupport.brightcove.com%252F%2
  dJ-pL7WJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796/code></pre>
    </dd>
    <dt><code>ad_mode_begin</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when control is handed over to an advertising agent by the playback platform.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=ad_mode_begin
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %3Dhttp%253A-%252F%252Fsupport.brightcove.com%252
  %26usg%3DAFQjCNEtLod%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>ad_mode_complete</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>Sent when control is handed over to an advertising agent by the playback platform.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=ad_mode_complete
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A-%2F%2Fsup-port.brightcove.com%2F
  &amp;source=http%3A-%2F%2Fwww.google.com
  %3Dhttp%253A-%252F%252Fsupport.brightcove.com%252F%2
  WZSGdJ-pL7WJaEeUJVlnw%26bvm%3Dbv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200
  &amp;time=1377191644796</code></pre>
    </dd>
    <dt><code>video_impression</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>The metadata for a video added to the player has finished loading and the player is ready to trigger the view event, either via auto-play or user interaction.</p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=video_impression
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A%2F%2Fwww.current-times.com%2F
  &amp;time=1377191644801
  &amp;source=http%3A%2F%2Fwww.google.com
  %252-F%26ei%3DoEYWUtCgEIXq9ATznoCgCQ
  %26usg%3DAFQjCNEtLod-Odx6bvm%3Dbv.5115-6542%2Cd.dmg
  &amp;video=2621468623001
  &amp;video_name=Democratic-Rivals%20Target%20Bill
  &amp;domain=videocloud
  &amp;account=1749339200</code></pre>
    </dd>
    <dt><code>video_view</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>A video has started playing back (either auto-play after loading, or due to user interaction).</p>
      <aside class="bcls-aside bcls-aside--information language-editable">Note: If your video has a pre-roll advertisement then this should be sent after the ad completes.</aside>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=video_view
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A%2F%2Fwww.current-times.com%2F
  &amp;video=2621468623001
  &amp;video_name=Debate-2
  &amp;video_duration=189
  &amp;time=1377191666432
  &amp;source=http%3A%2F%2Fwww.google.com%2Furl%
  %252F%26ei%3DoEYWUtCgEIXq9ATznoCgCQ%26us-g
  %3DAFQjCNEtv.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200</code></pre>
    </dd>
    <dt><code>video_engagement</code></dt>
    <dd>
      <h5>Intent/Meaning</h5>
      <p>A user watched a range of seconds of a video's timeline. This event is a heartbeat for tracking video engagement and will likely be sent many times during playback, depending on the user interaction and the length of the video. The Brightcove player instrumentation sends this event every 10 seconds, if playback is not interrupted. <strong>Events describing ranges over 20 seconds are discarded by the Analytics system.</strong></p>
      <h5>Example</h5>
<pre><code class="language-http">http://metrics.brightcove.com/tracker
  ?event=video_engagement
  &amp;session=581136_2018-07-03T18:34:46.214Z
  &amp;destination=http%3A%2F%2Fwww.current-times.com%2F
  &amp;video=2621468623001
  &amp;video_name=Debate-2
  &amp;video_duration=189
  &amp;time=1377191676589
  &amp;range=0..9
  &amp;source=http%3A%2F%2Fwww.google.com
  %2Furl%3Fsa%3Dt-%26rct%3Dj%26q%3D%26esrc%3Ds
  %26source%3Dweb%26cd%3D1%26ved%3D0CDYQFjAA
  %26url%3Dhttp%253A%252F%252Fwww.current-times.com
  %252F%26ei%3DoEYWUtC-gEIXq9ATznoCgCQ
  %26usg%3DAFQjCNEtLodOdxWZSGdJpL7WJ.51156542%2Cd.dmg
  &amp;domain=videocloud
  &amp;account=1749339200</code></pre>
    </dd>
  </dl>  
  </section>
  
  <section class="bcls-section video-cloud-only">
  <h2 id="all-event-parameters">Parameters for all events</h2>
  
  <p>Parameters for these events should include any information relevant to the current state of the system when the event occurred, and be as specific as possible. This section details parameters that can be sent with all events, and the following sections show parameters for specific events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width:16em;">Field</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>account</code></td>
        <td>String</td>
        <td>
        <p>account id</p>
        </td>
      </tr>
      <tr>
        <td><code>domain</code></td>
        <td>String</td>
        <td>
        <p>always equal to <code>videocloud</code></p>
  
        <p class="type-size">Allowed values: <code>"videocloud"</code></p>
        </td>
      </tr>
      <tr>
        <td><code>session</code></td>
        <td>String</td>
        <td>A session id that is as universally unique as possible - see the <a href="#minimal">Minimal Data</a> section above for more information</td>
      </tr>
      <tr>
        <td><code>device_os</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>Override to specify the OS of the device that originated the event in cases where the User Agent is unreliable (ignored unless both device os and device type are included or if the value submitted is not in the list of values shown here. <strong>Not typically included</strong>)</p>
  
        <p class="type-size">Allowed values: <code>"android"</code>, <code>"bada"</code>, <code>"ios"</code>, <code>"linux"</code>, <code>"mac"</code>, <code>"tv"</code>, <code>"os_x"</code>, <code>"rim"</code>, <code>"sybian"</code>, <code>"windows"</code>, <code>"other"</code></p>
        </td>
      </tr>
      <tr>
        <td><code>device_os_version</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The version of os being used by the device. When not specified, this will be calculated by parsing the user agent string for the tracking request</p>
        </td>
      </tr>
      <tr>
        <td><code>device_type</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>Override to specify the type of the device that originated the event in cases where the User Agent is unreliable (ignored unless both device os and device type are included or if the value submitted is not in the list of values shown here. <strong>Not typically included</strong>)</p>
  
        <p class="type-size">Allowed values: <code>"direct"</code>, <code>"mobile"</code>, <code>"tablet"</code>, <code>"tv"</code>, <code>"desktop"</code>, <code>"other"</code></p>
        </td>
      </tr>
      <tr>
        <td><code>event</code></td>
        <td>String</td>
        <td>
        <p>the event type</p>
  
        <p class="type-size">Allowed values: <code>"player_load"</code>, <code>"catalog_request"</code>, <code>"catalog_response"</code>, <code>"play_request"</code>, <code>"ad_mode_begin"</code>, <code>"ad_mode_complete"</code>, <code>"video_impression"</code>, <code>"video_view"</code>, <code>"video_engagement"</code>, <code>"error"</code></p>
        </td>
      </tr>
      <tr>
        <td><code>destination</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>URI that originated the event</p>
        </td>
      </tr>
      <tr>
        <td><code>source</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>URI that sent the end-user to the <code>destination</code> URI</p>
        </td>
      </tr>
      <tr>
        <td><code>time</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>Number</td>
        <td>
        <p>the timestamp for the event in epoch time (milliseconds)</p>
        </td>
      </tr>
      <tr>
        <td><code>country</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>ISO-3166 (alpha 2) region cISO-3166 (alpha 2) region code (override in case the system can not detect geographic information from the IP address) <strong>Not typically included</strong></p>
        </td>
      </tr>
      <tr>
        <td><code>country_name</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>Human readable country name (override in case the system can not detect geographic information from the IP address) <strong>Not typically included</strong></p>
        </td>
      </tr>
      <tr>
        <td><code>region</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>ISO-3166 (alpha 2) region code (override in case the system can not detect geographic information from the IP address) <strong>Not typically included</strong></p>
        </td>
      </tr>
      <tr>
        <td><code>region_name</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>Human readable region name (override in case the system can not detect geographic information from the IP address) <strong>Not typically included</strong></p>
        </td>
      </tr>
      <tr>
        <td><code>city</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>City name <strong>Not typically included</strong></p>
        </td>
      </tr>
      <tr id="userData">
        <td><code>user</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>A unique user identifier - if not provided or blank, Video Cloud uses the fallback method of using the <code>Source IP address + the User-Agent</code> String as the unique identifier; <strong>Note that Brightcove uses this information only to calculate unique users. The user data itself cannot retrieved via the API or Analytics module</strong></p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="user">User parameter</h3>
  
  <ul>
    <li>If the player/client application wants to track the unique viewer it should send a unique Id for the user as the user parameter to the collector.</li>
    <li>If the <code>user</code> is not provided or is blank, we use the fallback method of using the <code>Source IP address + the User-Agent String</code> as the unique identifier.</li>
    <li>The value of the user parameter is never stored in the logs/database, only a hash (using SHA-256) is stored.</li>
    <li>No cookies are set by the collector.</li>
  </ul>
  
  <h4 id="uniqueuser">Unique user</h4>
  
  <p>You can use Brightcove Player's plugin functionality to add unique video viewer data to the reported analytics. To do this, you will add a unique identifier to the <code>settings</code> object of the analytics functionality.</p>
  
  <p>Of course, how a unique user ID is captured varies from application to application, but for an example this code assumes a login URL is captured that contains unique user data, such as <strong>http://exampledomain.com/users/912389123</strong>. This unique URL is passed to the plugin.</p>
  
  <p>The plugin's code below performs the following tasks:</p>
  
  <ul>
    <li>Uses the standard syntax to create a Brightcove Player plugin with the plugin name defined as <code>uniqueUserForAnalyticsPlugin</code>. The plugin also accepts an <code>options</code> object, which contains data passed to the plugin.</li>
    <li>The <code>myPlayer</code> variable is assigned a reference to the player. As well, two other variables are created.</li>
    <li>The <code>userPath</code> variable is assigned the path passed to the plugin via the <code>options</code> object.</li>
    <li>The <code>uniqueViewer</code> variable is assigned the parsed version of the <code>userPath</code>, so only the user ID digits are assigned to the variable.</li>
    <li>A user property is added to the Analytics plugin's <code>settings</code> object.</li>
  </ul>
  
  <pre class="line-numbers">
  <code class="language-javascript notranslate">videojs.registerPlugin('uniqueUserForAnalyticsPlugin', function(options) {
  var myPlayer = this,
  userPath = '',
  uniqueViewer = '';
  //Assign uniqueViewer a value according to your app and business rules
  //In this example, parsing the path passed to the plugin in the options object
  userPath = options.path;
  uniqueViewer = userPath.substring( userPath.lastIndexOf('/') + 1 );
  //Assign a user variable to Analytic's settings object
  myPlayer.bcAnalytics.client.user(USER) = uniqueViewer;
  });
  </code>
  </pre>
  
  <p>This code would need to be altered to suit your application logic, then saved to an Internet accessible URL.</p>
  
  <p>From Studio, use the <strong>Plugins</strong> section to load the plugin in the player, as shown.</p>
  
  <figure class="bcls-figure"><img class="bcls-image" alt="Studio Plugin Section" src="//learning-services-media.brightcove.com/doc-assets/video-cloud-apis/analytics-api/data-collection/data-collection-api-overview/unique-user-plugin-studio.png" />
  <figcaption class="bcls-caption--image">Studio Plugin Section</figcaption>
  </figure>
  
  <p>Instead of the JSON that follows, you would pass to the plugin the string containing user data. Of course, the plugin code would need to be updated accordingly to extract the unique user ID.</p>
  
  <pre class="line-numbers">
  <code class="language-json">{
  "path": "http://exampledomain.com/users/912389123"
  }
  </code>
  </pre>
  
  <p>For more information on plugin development see the <a href="https://player.support.brightcove.com/coding-topics/step-step-plugin-development.html">Step-by-Step: Plugin Development</a> document.</p>
  
  <h3 id="device_type-and-device_os-parameters"><code>device_type</code>, <code>device_os</code>, <code>device_os_version</code>, <code>device_manufacturer</code>, and <code>browser_type</code> parameters</h3>
  
  <p>By default, the Analytics system will attempt to detect device type and OS information from the User-Agent header. If <strong>both</strong> <code>device_type</code> and <code>device_os</code> are sent, the information from the User-Agent header will be ignored in favor of <code>device_type</code> and <code>device_os</code>. <strong>In most cases, you do not need to send device, OS, and browser information</strong> -- this override should only be used if the User-Agent is unreliable or otherwise not available.</p>
  
  <p>The Analytics system will record <code>other</code> if a request includes unrecognized values for device parameter overrides.</p>
  
  <h3 id="geographic-data-parameters">Geographic data Parameters</h3>
  
  <p>By default, the Analytics system will attempt to detect geographic information from the remote IP address. This behavior can be overridden by passing <code>country</code>, <code>country_name</code>, <code>region</code>, <code>region_name</code>, <code>city</code> and <code>dma</code> parameters. <strong>In most cases, these parameters are not required</strong> -- this override should only be used if the remote IP address is unreliable or otherwise not available.</p>
  
  <p>The Analytics system will record <code>ZZ</code> or <code>unknown</code> if a request includes unrecognized values for overrides.</p>
  
  <h3 id="destination-and-source-parameters">destination and source Parameters</h3>
  
  <p>The <code>destination</code> and <code>source</code> parameters provide the URI that originated the event ( <code>destination</code>) and the URI that sent the user there ( <code>source</code>).</p>
  
  <p>The <code>source</code> parameter is used to determine traffic source information. If <code>source</code> is not specified, the Analytics system will treat events as being initiated by direct traffic.</p>
  
  <p>The <code>destination</code> parameter will be used to determine traffic destination information -- that is, where the video is being watched. If the URI does not contain an authority, the API will not record a <code>destination_domain</code>. The <code>destination_path</code> will be recorded as the path in the URI.</p>
  
  <p>During web playback, the URL in the address bar of the page where the video is playing is the <code>destination</code>, and the <code>source</code> is the referrer ( <code>top.document.referrer</code>).</p>
  
  <p>For example, when searching for "live streaming wirecast" on the Brightcove Support site and watching a video that comes up in the results:</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th>Parameter</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>source</code></td>
        <td>
        <pre class="line-numbers" style="white-space:pre-wrap;padding-top:1em;padding-bottom:1em;">
  <code class="language-http">https://support.brightcove.com/en/video-cloud/search/live%20streaming%20wirecast
  </code>
  </pre>
        </td>
      </tr>
      <tr>
        <td><code>destination</code></td>
        <td>
        <pre class="line-numbers" style="white-space:pre-wrap;padding-top:1em;padding-bottom:1em;">
  <code class="language-http notranslate">https://support.brightcove.com/en/video-cloud/training-videos/live-streaming-wirecast
  </code>
  </pre>
        </td>
      </tr>
    </tbody>
  </table>
  
  <p>If there is no URL (as in the case of native playback, for example), both <code>destination</code> and <code>source</code> should be valid URIs that identify where the video is playing back and how the user got there, respectively.</p>
  
  <p>Assuming the <code>destination</code> is a <a href="http://en.wikipedia.org/wiki/URI_scheme#Generic_syntax">valid URI</a>:</p>
  
  <pre>
  <code>&lt;scheme name&gt; : &lt;hierarchical part&gt; [ ? &lt;query&gt; ] [ # &lt;fragment&gt; ]
  ex. https://www.example.com/foo/bar/baz
  --------------/----------/
  |             |
  authority        path
  ---/    -------------------------/
  |                |
  scheme       hierarchical part
  </code>
  </pre>
  
  <p>the Analytics system will handle it as follows:</p>
  
  <p>If the URI contains an <strong>authority</strong>, the API response will use that authority as the <code>destination_domain</code> and any path provided as the <code>destination_path</code>. If the URI does not contain an authority, the API will not record a <code>destination_domain</code>. The <code>destination_path</code> will be recorded as the path in the URI. A <code>destination</code> without a hierarchical part (e.g. just a scheme) is considered invalid, as is any value without a scheme.</p>
  </section>
  
  <section class="bcls-section">
  <h2 id="parameters_for_specific_events">Parameters for specific events</h2>
  
  <h3 id="errorEvent">error event parameters</h3>
  
  <p>The following parameters should be sent with <code>error</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>error_code</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>Number</td>
        <td>
        <p>A platform specific error code associated with the event</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="catalog_requestEvent">catalog_request event parameters</h3>
  
  <p>The following parameters should be sent with <code>catalog_request</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>catalog_url</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The destination url associated with the catalog_request event</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="catalog_responseEvent">catalog_response event parameters</h3>
  
  <p>The following parameters should be sent with <code>catalog_response</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>catalog_url</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The destination url associated with the catalog_request event that initiated this response</p>
        </td>
      </tr>
      <tr>
        <td><code>response_time_ms</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>Number</td>
        <td>
        <p>The time, in milliseconds, between the catalog_request event and the catalog_response event</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="video_impressionEvent">video_impression event parameters</h3>
  
  <p>The following parameters should be sent with <code>video_impression</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>video</code> <span class="label label-optional" style="float:right;"> optional</span></td>
        <td>String</td>
        <td>
        <p>the video id</p>
        </td>
      </tr>
      <tr>
        <td><code>video_name</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the video name</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="video_viewEvent">video_view event parameters</h3>
  
  <p>The following parameters should be sent with <code>video_view</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>video</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the video id</p>
        </td>
      </tr>
      <tr>
        <td><code>video_name</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the video name</p>
        </td>
      </tr>
      <tr>
        <td><code>start_time_ms</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The time, in milliseconds, between initiation of playback and the first frame of the video being rendered. This can be different depending on the experience, for instance, if there are no pre-roll ads configured, this measurement is the time between the <code>play_request</code> and <code>video_view</code> events. If there is a preroll ad, the time between <code>ad_mode_begin</code> and <code>ad_mode_complete</code> should not be included</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <h3 id="engagementEventParams">video_engagement event parameters</h3>
  
  <p>The following parameters should be sent with <code>video_engagement</code> events.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th style="width: 30%">Field</th>
        <th style="width: 10%">Type</th>
        <th style="width: 70%">Description</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>video</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the video id</p>
        </td>
      </tr>
      <tr>
        <td><code>video_name</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the video name</p>
        </td>
      </tr>
      <tr>
        <td><code>range</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>the range of the video viewed for <code>video_engagement</code> events in the format <code>StartSecond..EndSecond</code> (the StartSecond and EndSecond values must be whole numbers [integers]) - range can be left out of an engagement event to show that during the period covered by the event, there was no viewing activity. (for example, when there is only re-buffering activity)</p>
        </td>
      </tr>
      <tr>
        <td><code>rendition_url</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The url to the most recently selected rendition. For example, for an HLS stream this would be the url to the most recently selected variant</p>
        </td>
      </tr>
      <tr>
        <td><code>rendition_indicated_bps</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The indicated bitrate, in bits per second, of the most recently selected rendition</p>
        </td>
      </tr>
      <tr>
        <td><code>rendition_mime_type</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The mime type of the most recently selected rendition</p>
        </td>
      </tr>
      <tr>
        <td><code>rendition_height</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The encoded height of the video rendition in pixels</p>
        </td>
      </tr>
      <tr>
        <td><code>rendition_width</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The encoded width of the video rendition in pixels</p>
        </td>
      </tr>
      <tr>
        <td><code>rebuffering_seconds</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The number of seconds the user spent waiting for video to playback due to un-requested delay during the engagement period</p>
        </td>
      </tr>
      <tr>
        <td><code>rebuffering_count</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The number of times playback stopped due to re-buffering during the represented engagement period delay during the engagement period</p>
        </td>
      </tr>
      <tr>
        <td><code>forward_buffer_seconds</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The number of seconds of video currently residing in the forward buffer</p>
        </td>
      </tr>
      <tr>
        <td><code>measured_bps</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The ratio of the number of bits included in the most recently downloaded segment to the time spend downloading that segment, in bits per second</p>
        </td>
      </tr>
      <tr>
        <td><code>player_width</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The current pixel width of the player at the end of the engagement range</p>
        </td>
      </tr>
      <tr>
        <td><code>player_height</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>The current pixel height of the player at the end of the engagement range</p>
        </td>
      </tr>
      <tr>
        <td><code>dropped_frames</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>String</td>
        <td>
        <p>dropped_frames</p>
        </td>
      </tr>
      <tr>
        <td><code>video_duration</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>Number</td>
        <td>
        <p>the duration of the video in seconds</p>
        </td>
      </tr>
      <tr>
        <td><code>video_seconds_viewed</code> <span class="label label-optional" style="float:right;">optional</span></td>
        <td>Number</td>
        <td>
        <p>count of watched seconds since the last update for <code>video_engagement</code> events</p>
        </td>
      </tr>
    </tbody>
  </table>
  
  <p>The <code>video_engagement</code> event is a means of tracking video engagement while a video is playing back, and will likely be sent many times during playback. (The Flash/HTML5 player instrumentation sends this event every 10 seconds, if playback is not interrupted.) <strong>At present, events describing ranges over 20 seconds are discarded by the Analytics system, so it is necessary to send these events more frequently.</strong></p>
  
  <p>There are two forms that a <code>video_engagement</code> event can take (other parameters omitted for brevity):</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th>Example</th>
        <th>Meaning</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td>
        <pre class="line-numbers" style="white-space:pre-wrap;padding-top:1em;padding-bottom:1em;">
  <code class="language-http notranslate">event=video_engagement&amp;video=123&amp;video_duration=75&amp;range=0..9
  </code>
  </pre>
        </td>
        <td>Video <code>123</code> with a duration of 75 seconds played seconds 0 through 9 (for a total of 10 seconds viewed).</td>
      </tr>
      <tr>
        <td><code>event=video_engagement&amp;video=123&amp;video_seconds_viewed=10</code></td>
        <td>10 seconds of video <code>123</code> were viewed.</td>
      </tr>
    </tbody>
  </table>
  
  <p>While both versions track viewed seconds, the version that includes <code>video_duration</code> and <code>range</code> also contains information necessary to calculate additional engagement data, and is <strong>the preferred way</strong> to send <code>video_engagement</code> event data to the Analytics system. For live streams, or in cases where the video's timeline is continually changing during playback or is otherwise unreliable, <code>video_seconds_viewed</code> will be the only data available. For VOD, unless <code>duration</code> is unavailable, the <code>video_engagement</code> event should include <code>video_duration</code> and <code>range</code>.</p>
  
  <table class="bcls-table">
    <thead class="bcls-table__head">
      <tr>
        <th>Parameters</th>
        <th>Derived engagement metrics (API)</th>
      </tr>
    </thead>
    <tbody class="bcls-table__body">
      <tr>
        <td><code>video_duration</code>, <code>range</code></td>
        <td><code>video_seconds_viewed</code>, <code>video_percent_viewed</code>, <code>engagement_score</code>; engagement curve data</td>
      </tr>
      <tr>
        <td><code>video_seconds_viewed</code></td>
        <td><code>video_seconds_viewed</code></td>
      </tr>
    </tbody>
  </table>
  
  <p>If all three parameters ( <code>video_duration</code>, <code>range</code> and <code>video_seconds_viewed</code>) are sent along with a <code>video_engagement</code> event, the Analytics system will calculate engagement metrics from the <code>video_duration</code>+ <code>range</code> parameters.</p>
  
  <h3 id="changesFromV1">V2 Changes</h3>
  
  <p>This section provides a summary of changes from v1 to v2 of the Data Collector for those who have been using v1.</p>
  
  <h3>Base url for tracker</h3>
  
  <pre>
  <code>http(s)://metrics.brightcove.com/v2
  </code>
  </pre>
  
  <h3>Additional Fields Supported on All Events:</h3>
  
  <p><strong>device_os_version</strong>: The version of os being used by the device. When not specified, this will be calculated by parsing the user agent string for the tracking request.</p>
  
  <p><strong>platform_version</strong>: Used to indicate that a new release of the specified platform is being used to send the events.</p>
  
  <h3>New Events For V2</h3>
  
  <p><strong>catalog_request</strong>: Sent when a request to the videocloud catalog api is made - note that this event is for internal use, and not exposed in the Analytics Module or via the Analytics API.</p>
  
  <ul>
    <li><strong>catalog_url</strong>: The destination url associated with the <code>catalog_request</code> event - note that this event is for internal use, and not exposed in the Analytics Module or via the Analytics API..</li>
  </ul>
  
  <p><strong>catalog_response</strong>: Sent when a response to a prior <code>catalog_request</code> is received - note that this event is for internal use, and not exposed in the Analytics Module or via the Analytics API.</p>
  
  <ul>
    <li><strong>catalog_url</strong>: The destination url associated with the <code>catalog_request</code> event that initiated this response - note that this event is for internal use, and not exposed in the Analytics Module or via the Analytics API..</li>
    <li><strong>response_time_ms</strong>: The time, in milliseconds, between the <code>catalog_request</code> event and the <code>catalog_response</code> event - note that this event is for internal use, and not exposed in the Analytics Module or via the Analytics API..</li>
  </ul>
  
  <p><strong>play_request</strong>: Sent when the playback is initiated either by the user expressly clicking the play button, or automatically when the platform triggers playback in an auto-play scenario.</p>
  
  <p><strong>ad_mode_begin</strong>: [Replaces <code>ad_start</code>] Sent when control is handed over to an advertising agent by the playback platform.</p>
  
  <p><strong>ad_mode_complete</strong>: [Replaces <code>ad_end</code>]Sent when control is handed back from the advertising agent to the playback platform.</p>
  
  <p><strong>error</strong>: Sent when fatal errors which disrupt the playback experience are encountered.</p>
  
  <ul>
    <li><strong>error_code</strong>: A platform specific error code associated with the event.</li>
  </ul>
  
  <h3>Updated Events for V2</h3>
  
  <p><strong>video_view</strong>: Includes new latency measurements</p>
  
  <ul>
    <li><strong>load_time_ms</strong>: The time, in milliseconds, between initiating data load for the video and the video becoming playable.</li>
    <li><strong>start_time_ms</strong>: The time, in milliseconds, between initiation of playback and the first frame of the video being rendered. This can be different depending on the experience, for instance, if there are no pre-roll ads configured, this measurement is the time between the 'play_request' and <code>video_view</code> events. If there is a preroll ad, the time between <code>ad_mode_begin</code> and <code>ad_mode_complete</code> should not be included.</li>
  </ul>
  
  <p><strong>video_engagement</strong>: Includes additional rendition selection, bitrate measurements, and buffering information. A subtle change to video engagement was also made in that it should be sent periodically even if no viewing occurred during the engagement period. This change is to enable tracking re-buffering delays and counts that cause users to wait for playback.</p>
  
  <ul>
    <li><strong>range</strong>: The range parameter is now optional, range can be left out of an engagement event to show that during the period covered by the event, there was no viewing activity. (for example, when there is only re-buffering activity)</li>
    <li><strong>rendition_url</strong>: The url to the most recently selected rendition. For example, for an HLS stream this would be the url to the most recently selected variant.</li>
    <li><strong>rendition_indicated_bps</strong>: The indicated bitrate, in bits per second, of the most recently selected rendition.</li>
    <li><strong>rendition_mime_type</strong>: The mime type of the most recently selected rendition.</li>
    <li><strong>rendition_height</strong>: The encoded height of the video rendition in pixels</li>
    <li><strong>rendition_width</strong>: The encoded width of the video rendition in pixels</li>
    <li><strong>rebuffering_seconds</strong>: The number of seconds the user spent waiting for video to playback due to un-requested delay during the engagement period.</li>
    <li><strong>rebuffering_count</strong>: The number of times playback stopped due to re-buffering during the represented engagement period.</li>
    <li><strong>forward_buffer_seconds</strong>: The number of seconds of video currently residing in the forward buffer.</li>
    <li><strong>measured_bps</strong>: The ratio of the number of bits included in the most recently downloaded segment to the time spend downloading that segment, in bits per second.</li>
    <li><strong>player_width</strong> The current pixel width of the player at the end of the engagement range.</li>
    <li><strong>player_height</strong> The current pixel height of the player at the end of the engagement range.</li>
    <li><strong>dropped_frames</strong>: The number of frames that were dropped from video playback during this engagement period</li>
  </ul>
  </section>
  </article>
  